#include <bits/stdc++.h>
#include <assert.h>
using namespace std;
typedef long long ll;
typedef long double ld;
#define PB push_back
#define MP make_pair
#define MOD 1000000007LL
#define MAXN 10003
#define MAXLOGN 15
#define INF 9223372036854775807LL
bool a[MAXN+1];
vector<ll> pv;
ll b[MAXN+1];
ll g[MAXLOGN+1][MAXN+1];
void sieve() {
	for (ll i = 0; i <= MAXN; i++) a[i] = true;
	a[0] = false; a[1] = false;
	ll lim = sqrt(MAXN)+1;
	for (ll i = 2; i <= lim; i++) {
		if(a[i]) {
			for (ll j = i*i; j <= MAXN; j+=i) {
				a[j] = false;
			}
		}
	}
	for (ll i = 2; i <= MAXN; i++) {
		if (a[i]) pv.PB(i);
	}
}

ll modexp(ll base, ll e) {
	ll ans = 1;
	while(e > 0) {
		if (e % 2 == 1) {
			ans = (ans * base) % MOD;
			e--;
		}
		else {
			base = (base*base) % MOD;
			e /= 2;
		}
	}
	return ans;
}
ll binom(ll n, ll k) {
	ll denom = (invfact[n-k]*invfact[k])%MOD;
	return (fact[n]*denom)%MOD;
}
void init() {
	fact[0] = 1;
	for (ll i = 1; i < MAXF; i++) {
		fact[i] = (fact[i-1] * i)%MOD;
	}
	for (ll i = 0; i < MAXF; i++) {
		invfact[i] = inv(fact[i]);
	}
}
class PolynomialGCD {
	public:
	int gcd(string s) {
		sieve();
		ll n = s.size();
		for (ll i = 0; i < n; i++) {
			b[i] = s[i] - '0';
		}
		ll ans = 1;
		for (auto&p: pv) {
			if (p > n) continue;
			ll elim = -1;
			ll ppowlim = -1;
			{
				ll ppow = p;
				ll e = 0;
				while(ppow <= n) {
					assert(e <= MAXLOGN);
					ll xlim = min(n,ppow);
					for (ll x = 0; x < xlim; x++) {
						ll sum = 0;
						for (ll y = x; y < n; y += ppow) {
							sum += b[y];
						}
						g[e][x] = sum;
						//printf("p:%lld e:%lld x:%lld sum:%lld\n",p,e,x,sum);
					}
					ppow *= p;
					e++;
				}
				elim = e-1;
				ppowlim = ppow/p;
			}
			ll ex = INF;
			//printf("p:%lld pplim:%lld elim:%lld\n",p,ppowlim,elim);
			{
				ll initlim = min(ppowlim,n);
				for (ll init = 0; init < initlim; init++) {
					ll sum = 0;
					ll ppow = ppowlim;
					ll num = 0;
					for (ll y = init; y < n; y += ppow) {
						num++;
					}
					ll add = 0;
					if (num >= p) {
						add = INF;
						for (ll y = init; y < n; y += ppow) {
							add = min(add, b[y]);
						}
					}
					sum += add;
					for (ll e = elim; e >= 0; e--,ppow/=p) {
						ll x = init % ppow;
						if (x < n) {
							sum += g[e][x];
						}
						//printf("Add e:%lld x:%lld g:%lld\n",e,x,g[e][x]);
					}
					//printf("init:%lld sum:%lld\n",init,sum);
					ex = min(ex, sum);
				}
			}
			ll tomul = modexp(p, ex);
			ans = (ans * tomul) % MOD;
		}
		return ans;
	}
};
// BEGIN CUT HERE
#include <ctime>
#include <cmath>
#include <string>
#include <vector>
#include <sstream>
#include <iostream>
#include <algorithm>
using namespace std;

int main(int argc, char* argv[])
{
	if (argc == 1) 
	{
		cout << "Testing PolynomialGCD (500.0 points)" << endl << endl;
		for (int i = 0; i < 20; i++)
		{
			ostringstream s; s << argv[0] << " " << i;
			int exitCode = system(s.str().c_str());
			if (exitCode)
				cout << "#" << i << ": Runtime Error" << endl;
		}
		int T = time(NULL)-1451023437;
		double PT = T/60.0, TT = 75.0;
		cout.setf(ios::fixed,ios::floatfield);
		cout.precision(2);
		cout << endl;
		cout << "Time  : " << T/60 << " minutes " << T%60 << " secs" << endl;
		cout << "Score : " << 500.0*(.3+(.7*TT*TT)/(10.0*PT*PT+TT*TT)) << " points" << endl;
	}
	else
	{
		int _tc; istringstream(argv[1]) >> _tc;
		PolynomialGCD _obj;
		int _expected, _received;
		time_t _start = clock();
		switch (_tc)
		{
			case 0:
			{
				string s = "131";
				_expected = 24;
				_received = _obj.gcd(s); break;
			}
			case 1:
			{
				string s = "00000";
				_expected = 1;
				_received = _obj.gcd(s); break;
			}
			case 2:
			{
				string s = "2014";
				_expected = 16;
				_received = _obj.gcd(s); break;
			}
			case 3:
			{
				string s = "31415926535";
				_expected = 659897170;
				_received = _obj.gcd(s); break;
			}
			case 4:
			{
				string s = "6457075206847507695843715632209735504006078919302286307979341726890214004816835175140305334653703620828005654000756301574656569424324297264559472538100002041910365011723603488132215889724279519753290729713474450744810493545856816418696997309477720472196226346097895830423457324888082068165624158762012426310973258967499541573087900786542807046049437111855674580017785795652946385721883135136787801739261076085149571238450434850939249568973448108957308543344818252417286497663745331070193491031009386111504315505492754585788410202576989387366939430655609546575963341126303115895855681462033187011115977651142367711928953726770700665541446572501306497516633374191781211629385597876149744958352109682584936692230157203410482658183410733872431564375264687185754753269870366304599702184902383876655423615081671287241316017782032786638711842799210814471782134075989171841923628115955568421366401353352960716410122888597779642304691385150297821078049237187016511796661696320649129727365048768412989241526068416000107408965561883852415443638033941741984844551084561775506454054332754740916851910993015724660575363920412539518776095411303634943288973219654652062477017959139983911942212073117960749696300795904928024236026300488422010125859161694099524395131336070196784366178695666890557310538925634020176950707060317325412245567816663023201719534026089241689788572593834456093300115059731485115340107203192810979040393399273148805884139085835012602115486471641060480926171255227253721317106555814343609343977983863072607476889461340531591124845762686784955598318640983595689114136585693134233120033388883469965675829653404649502466441490767026660998206178378410247577122467284839715389584248470231364457838813259627702657615801735026484284768388844730483306619484465114027674138148590476985047588560918093313119365750727800559709465711548335106484123137572317477298209977263512968241254397962974684468611441877669362716753690314715230445185478845556639990739231270497862497925318177580793564894291045422079869007465655222609157487611229623889614503050450571226333350725167559738730636218614510165579897488977579689686684185005211546483420429061178719627920413640358961965707751588673237846379158182800037033427110261726268872460396667773028920943347425745495985580526373450319039756545305178979739617951867345038453693506379507381196372289270181481783456230667230791377540287889457113333173980854278735014378546767438988149808220441298146149631788447455858698391758714468302437114918648970148973798191665556496776094914148577902515826658252350146390802073900329017361440640574388432206457529252769571757495168258990870360215446618744421455363520990785628698332386740100102299073068730953253938354203579503092871592462366769449979523173405416987165834942697095323002665331124688237450408794435707873978522287277217486624776982251351468047795840549205912875491974941467247671917488673132732338577133545529875719680203488299687803985113143147240141776109691654442076938494604123734569794243164766515866601744747913500726250711778067816162955100795134164604481406838980534544460674455180499232768215654568537657206116679018535393326877340837206200924211869336734119216723329134892661297787126350343161677360360498097475290736365680448170744168499659165147999647771487923432855916837915791850830991727923579581316878517077952572419482386127244446089118356428587694930748757414422263925115821065482359106541262388700664152797405502189679000803603041789594903112106934242451238212438252439268175192620694553385503971197620335819259466605353316083063308808971788846947107048529293278461547941996549536182686914158008515712322680990901598968014728716683669471260335128593833553425052107998789534380704569105185876795598447033928800963515924423145367550305759713276871633810640588382038790757502344540882232347410168939925122045246363215174465608121231759772470719359943732905798991910444506687255503065638251312807526366430518655084463020442285993489020385605018749799537683943779040776802388616972061473016248377874145911863871308987181461253799347589572506910289402954911243515989816203922015197161794312112645523977630988610926890181095193378485843869293535849549031065224434132155631792858056656611287633105863410138576912900407873632590831602794547760214783609763925155267651701931615278815863417076701847196207553289869512327398479837356070707575036957573693089273691511683107801579830695028861446514551769327150047406403389242084564379275974398874527719320620141302694562357235836659701206822442219196612108401141901448629083788219213388178275237981485847034666655915604468764954707705870856608538037461382111706016774419046238502147454501252972667878899548582706448389126636543839318799321162591286673598828562806402545749531932594103027021069725612626648768943844082891064402311894786617566015050124941971698055020264593457684492560385092182059615892501091637863022062358264774173833667401704036023042255408275028052472394697422746316067374792901485953174987457343956777610211986026748022895560971613519211423766736570625826667698667366840107107062657307680523692466663354545204841464751670701685142019624978008131225914303865744438750731487052554726175042506538416135829091547158252825540353622651498140212494414693968035139727272499631043025806320997272348475716696337712750400737735067707326666080428682665817512253101946713457855619443152535195187696404812490951185869673465707262845631002454707786307077941005191517723979035655560862464446586215012233868945096724088533762549923177081973984160543297547180731839453082640984200516126507018681221995408557193765947144101084175547428755350953869997139936200019771561953525191639480751443839974005640092695721238302581221616960402344703340085945694097866820537593456413062186442848350840444199010785468347624365720489031196652669061281157400533421466040821185523742282127854164055790944265786554408929842006648044678258445256697378328931265273621372667101510274739246013607655042561277632944703666480087718429900007072679743704308582207981664590144826040135672781240567038667189037404153826584988155555554437923450443002364478449716737386944645001112356022593281409142369942223443388635716541742853671104724431235818842702909279198851954457950780043071034811737840951621912794487192123989982525819035088987610876755146166190774056594239660345594995456979709736666314173856208828173834428934213630657776128034153539336279262253470284993605826723842527556400535313972002738105535782302434156979243755263840737855123285951916496875697535395469773992608365903430397547029282758465366747651163265272607046208509810715974191028859993450158667762566965895670800836484698138727907854929213335759236880529636020788933917496637461243129055296989016769234912242726644703862523087681463332046894894381786997151411022924588064731863384845010573794656682370912523718398008355480275106159682971019581863076290705552058752364721144082728322284490326469294044679980649815073685198172719569775231819673521428372741296465871391799596320680896200614022736098697912451207887276260455806848033772927637844486316226014407534634083065303768320200076579365585159060549421423956405018289362403703139027563304246582110756936878896486273527379936356713985449848979157955564935078214780543701749612963283789556540015229271820300830510400338293969809290610179167676001882443762343207089586269530869094693159265572884740678854056243207795049986111214922925577501760839586340130739171909392859138190741947923106857524152219393483950249608942481507289092384337262344273735229465313871789912905506554498438075157015472078777671148222344532945804537090314679405284175180077310314453983976314222945045095055120093751614434330885377653183710663819887434127182496890875375424108857427933780226279419437588027304814145167678279204893319972119174863152326516723797382516152714011560671357589372855851910757542243885368318253361097360525491313898181014628842592002400203621068945218109217006814681030205944652912643791563964265989400779242430934439533199789375908396903981804264612053861244351337930062432047937847889266662903007470061769281571115962688825132826831886850583644127844760033937543201890332338993034834661776032780898083099094261153573093419846030240494953475941434831943458035898035112121616235560500915131777586690208343018373709203863510609762110113532280126561216724542816743360255151028606950379479135192456354623544089427261147041422445851966799391056201641373454988347369457338362248680991737637358383980955691603977271780763659371287962619511867797367806159399630636387760944384323567376415537089230172323874621846485664315024781761054017085450766282963279779843514239180318514165582736571864869051229101097810232709853891465214712890158543563030820370764275825356935505783971081947773557374286845819274358423182971613007537814288404130285313240641082299253454639412958986953901956865529444276137570755221948576353007108891924083893804965901779783959510528123696097198755251767605113926748247854525151227693177812238268961954018753672549644311466159300137974323954554539010698725645858240797838026025821848419471488513364997450212205411350783256461038959549074729986105112117804496135607319447735932303860355007869592526554895458265408628630142013941856494728274585408772536853501936863683678549173853807046612835069945570810671102420543122693848107495004311039569403765644334778281740027071292376284509984739078001726086106487813620365594042555259743643388558292743221990678255475362997003192351655913543839505516202955824891350909530909556896850782579191055353927596204615279636557851089863415221584663415873970220861887215014507440594783115750068076905303968135346869345484634459483716902298782644960215223775651501954550928368599050828177794458450996028222704550882917804016099254626273807306994053828692055504237569514885928573143812427083528936657306416128854924197048566572483993951211775352707652315162449122680195219364224439437799598645494767696633332944588597639498273537814691779510483138288593101556969885414733674291643589398735288457591238139186312867256895270";
				_expected = 794949223;
				_received = _obj.gcd(s); break;
			}
			case 5:
			{
				string s = "23036";
				_expected = 256;
				_received = _obj.gcd(s); break;
			}
			case 6:
			{
				string s = "11111111";
				_expected = 40320;
				_received = _obj.gcd(s); break;
			}
			case 7:
			{
				string s = "1111111111";
				_expected = 3628800;
				_received = _obj.gcd(s); break;
			}
			case 8:
			{
				string s = "8444115";
				_expected = 69672960;
				_received = _obj.gcd(s); break;
			}
			case 9:
			{
				string s = "5056556046294091012486650305522195891012093267230286739137848830274466995003650170831569074204605131116628660685010110841621035949067567711130643126933602091557230993614840809174721355273486282757647813928405233451410548470055305071555325161453765739215479090218528438978180795667253546657299044476806425583556689304797902996967507853169232281490511408745024498472357523294120070441743484104458417745904645623673747417994765837287902423102985798473679899054054881182825448018698933756372218631866095321414140382435850846530377401783975990012238171043197646026568581982452810363106728760936403110622035909173526976272846038319061076997521469208053681528888177281221706856203989804352890241320725886438038249253885116296801739025914350611272277102994395256174605256328337598815469852996996415602362398818387855656850836901577773286597537120406868620983393143746461812262266584614650441879861167680556473927167950099265211116523933811432265954527393932006403821308982651836615556917825106546009136515353";
				_expected = 333402496;
				_received = _obj.gcd(s); break;
			}
			default: return 0;
		}
		cout.setf(ios::fixed,ios::floatfield);
		cout.precision(2);
		double _elapsed = (double)(clock()-_start)/CLOCKS_PER_SEC;
		if (_received == _expected)
			cout << "#" << _tc << ": Passed (" << _elapsed << " secs)" << endl;
		else
		{
			cout << "#" << _tc << ": Failed (" << _elapsed << " secs)" << endl;
			cout << "           Expected: " << _expected << endl;
			cout << "           Received: " << _received << endl;
		}
	}
}

// END CUT HERE
